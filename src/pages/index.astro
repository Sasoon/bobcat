---
import { Image } from "astro:assets";
import Base from "@/layouts/Base.astro";
import Cta from "@/layouts/components/Cta.astro";
import { markdownify } from "@/lib/utils/textConverter";
import { getEntryBySlug } from "astro:content";
import Services from "@/codestitch/services.astro";
import CardPricing from "@/codestitch/2-card-pricing.astro";
import SideBySide from "@/codestitch/side-by-side.astro";
import Btn from "@/codestitch/btn.astro";

const homepage = await getEntryBySlug("homepage", "index");
const { banner, feature, services, call_to_action } = homepage.data;
---

<style>
  .parallax-section {
    position: relative;
    overflow: hidden;
  }

  .parallax-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 120%; /* Slightly taller than the container */
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' version='1.1' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns:svgjs='http://svgjs.dev/svgjs' width='1440' height='560' preserveAspectRatio='none' viewBox='0 0 1440 560'%3e%3cg mask='url(%26quot%3b%23SvgjsMask1145%26quot%3b)' fill='none'%3e%3cpath d='M1157.528120287476 196.74871924554995L1277.1257010403258 293.5969305479583 1254.3763315898843 77.15113849270006z' fill='rgba(28%2c 83%2c 142%2c 0.4)' class='triangle-float3'%3e%3c/path%3e%3cpath d='M964.6946303153553 176.64718914641043L964.6946303153553 266.17093282895814 1054.218373997903 266.17093282895814 1054.218373997903 176.6471891464104z' fill='rgba(28%2c 83%2c 142%2c 0.4)' class='triangle-float3'%3e%3c/path%3e%3cpath d='M248.90002296232262 238.6850634221973L106.72943557087265 296.12570927073216 164.1700814194075 438.2962966621821 306.3406688108575 380.85565081364723z' fill='rgba(28%2c 83%2c 142%2c 0.4)' class='triangle-float3'%3e%3c/path%3e%3cpath d='M57.039002873229194 429.5631247508709L-4.847218325192685 352.9909106704393-37.087495557135824 432.78839699771845z' fill='rgba(28%2c 83%2c 142%2c 0.4)' class='triangle-float2'%3e%3c/path%3e%3cpath d='M1208.9452303167786 411.0612881754855L1258.9330914679147 518.5278779374147 1319.8325256086237 434.7069978192181z' fill='rgba(28%2c 83%2c 142%2c 0.4)' class='triangle-float2'%3e%3c/path%3e%3cpath d='M308.063752033158 92.95865585438374L216.72898034476725 7.787603366020392 131.5579278564039 99.12237505441114 222.89269954479465 184.29342754277448z' fill='rgba(28%2c 83%2c 142%2c 0.4)' class='triangle-float3'%3e%3c/path%3e%3cpath d='M1205.347350116711 207.006669730669L1259.916343644937 112.49040042188449 1165.4000743361523 57.92140689365857 1110.8310808079264 152.43767620244307z' fill='rgba(28%2c 83%2c 142%2c 0.4)' class='triangle-float1'%3e%3c/path%3e%3cpath d='M546.4672387286942 214.91067844925902L458.3738946264026 120.44213267252422 363.9053488496678 208.53547677481575 451.99869295195936 303.0040225515505z' fill='rgba(28%2c 83%2c 142%2c 0.4)' class='triangle-float1'%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cmask id='SvgjsMask1145'%3e%3crect width='1440' height='560' fill='white'%3e%3c/rect%3e%3c/mask%3e%3cstyle%3e %40keyframes float1 %7b 0%25%7btransform: translate(0%2c 0)%7d 50%25%7btransform: translate(-10px%2c 0)%7d 100%25%7btransform: translate(0%2c 0)%7d %7d .triangle-float1 %7b animation: float1 5s infinite%3b %7d %40keyframes float2 %7b 0%25%7btransform: translate(0%2c 0)%7d 50%25%7btransform: translate(-5px%2c -5px)%7d 100%25%7btransform: translate(0%2c 0)%7d %7d .triangle-float2 %7b animation: float2 4s infinite%3b %7d %40keyframes float3 %7b 0%25%7btransform: translate(0%2c 0)%7d 50%25%7btransform: translate(0%2c -10px)%7d 100%25%7btransform: translate(0%2c 0)%7d %7d .triangle-float3 %7b animation: float3 6s infinite%3b %7d %3c/style%3e%3c/defs%3e%3c/svg%3e");
    background-size: cover;
    background-position: center;
    transform: translateY(0);
    will-change: transform;
  }

  .parallax-content {
    position: relative;
    z-index: 1;
  }
</style>

<Base>
  <!-- banner -->
  <section class="section bg-white parallax-section flex h-screen items-center">
    <div class="parallax-bg"></div>
    <div class="parallax-content w-full">
      <div class="container">
        <div
          class="mx-auto flex flex-wrap lg:bg-[url('https://ucarecdn.com/1836492a-e9cc-4780-862e-c2828e85ead2/-/preview/1000x750/')] md:bg-contain md:bg-no-repeat md:bg-right lg:flex-nowrap justify-items-start w-full"
        >
          <div class="content w-full lg:w-[60%]">
            <h1 class="font-primary mx-0 font-bold text-midnight-teal my-4">
              {banner?.title}
            </h1>
            {
              banner?.content && (
                <p class="mt-4" set:html={markdownify(banner.content)} />
              )
            }

            <Btn
              href="/about"
              ariaLabel="Read more about us"
              text="Find out more"
            />
          </div>
          <!-- <div class="image w-full mt-12 sm:mt-24 lg:mt-0">
            {
              banner?.image && (
                <Image
                  class="mx-auto mt-4"
                  src={banner?.image}
                  width={750}
                  height={390}
                  alt="banner image"
                />
              )
            }
          </div> -->
        </div>
      </div>
    </div>
  </section>

  <!-- Features
  <section class="section bg-midnight-teal">
    <div class="container">
      <div class="text-center">
        <h2>{markdownify(feature!.title)}</h2>
      </div>
      <div class="mt-8 grid gap-x-8 gap-y-6 sm:grid-cols-2 lg:grid-cols-3">
        {
          feature!.features.map((item: any, i: number) => (
            <div class="feature-card rounded-xl bg-white p-5 pb-8 text-center">
              {item.icon && (
                // <Image
                //   class="mx-auto"
                //   src={item.icon}
                //   width={30}
                //   height={30}
                //   alt=""
                // />
                <img
                  class="mx-auto"
                  alt={item.icon}
                  src={item.icon}
                  width={30}
                  height={30}
                />
              )}
              <div class="mt-4">
                <p class="h5" set:html={markdownify(item!.name)} />
                <p class="mt-3">{item.content}</p>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </section> -->

  <Services />
  <SideBySide />
  <CardPricing />

  <!-- {
    services!.map((service: any, index: number) => {
      const isOdd = index % 2 > 0;
      return (
        <section class={`section ${isOdd && "bg-midnight-teal"}`}>
          <div class="container">
            <div class="items-center gap-8 md:grid md:grid-cols-2">
              <div class={`service-carousel ${!isOdd && "md:order-2"}`}>
                {service!.images!.length > 1 ? (
                  <div class="swiper">
                    <div class="swiper-wrapper">
                      {service!.images?.map((image: string) => (
                        <div class="swiper-slide">
                          <Image
                            class="mx-auto"
                            src={image}
                            width={538}
                            height={328}
                            alt=""
                          />
                        </div>
                      ))}
                    </div>
                    <div class="pagination" />
                  </div>
                ) : (
                  <Image
                    class="mx-auto"
                    src={service!.images![0]}
                    width={538}
                    height={328}
                    alt=""
                  />
                )}
              </div>

              {/* Content */}
              <div
                class={`service-content mt-5 md:mt-0 ${!isOdd && "md:order-1"}`}
              >
                <h2
                  class={`font-bold leading-[40px] ${!isOdd ? "text-midnight-teal" : ""}`}
                >
                  {service?.title}
                </h2>
                <p class={`mt-4 mb-2 ${isOdd ? "text-body" : ""}`}>
                  {service?.content}
                </p>
                {service?.button?.enable && (
                  <a
                    href={service?.button.link}
                    class="cta-link inline-flex items-center text-tropical-teal"
                  >
                    {service?.button.label}
                    <img
                      class="ml-1"
                      src="/images/arrow-right.svg"
                      width={18}
                      height={14}
                      alt="arrow"
                    />
                  </a>
                )}
              </div>
            </div>
          </div>
        </section>
      );
    })
  } -->

  <!-- <script>
    import { Swiper } from "swiper";
    import "swiper/css";
    import "swiper/css/pagination";
    import { Autoplay, Pagination } from "swiper/modules";

    // astro:page-load event is fired when the page is loaded
    document.addEventListener("astro:page-load", () => {
      new Swiper(".service-carousel .swiper", {
        modules: [Pagination, Autoplay],
        autoplay: {
          delay: 3000,
        },
        pagination: {
          type: "bullets",
          el: ".service-carousel .pagination",
          clickable: true,
        },
      });
    });
  </script> -->
  <!-- ./End service -->

  <!-- Call to Action -->
  <!-- <Cta cta={call_to_action} /> -->
</Base>

<script>
  document.addEventListener("astro:page-load", () => {
    const parallaxBg = document.querySelector(".parallax-bg");

    window.addEventListener("scroll", () => {
      const scrollPosition = window.pageYOffset;
      parallaxBg.style.transform = `translateY(${scrollPosition * 0.5}px)`;
    });
  });
</script>
